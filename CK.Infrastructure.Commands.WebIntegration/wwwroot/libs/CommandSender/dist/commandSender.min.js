var CK;!function(n){var e;!function(n){var e=function(){function n(){}return n.prototype.post=function(n,e){var t=JSON.stringify(e);return $.ajax(n,{type:"POST",data:t,contentType:"application/json",dataType:"JSON"})},n}();n.AjaxSender=e;var t=function(){function n(n,e){var t=this;this._receivedResponses=new Array,this._hubConnection=n,this._hubConnection.proxies[e].client.ReceiveCommandResponse=function(n){t._receivedResponses.push(n)}}return n.prototype.listen=function(n,e){if(e!==this._hubConnection.id)throw new Error("Try to listen to the wrong ConnectionId...");var t=this,o=$.Deferred(),r=setInterval(function(){t._receivedResponses.forEach(function(e,t,i){e.CommandId===n&&(clearInterval(r),i.splice(t,1),o.resolve(e))})},200);return o.promise()},n}();n.SignalRListener=t;var o=function(){function n(n,t,o,r){this._prefix=n,this._connectionId=t,this._sender=o||new e,this._listener=r}return n.prototype.send=function(n,e){var t=this;console.info("Sending Command to route: "+n);var o=this._prefix+"/"+n+"?c="+this._connectionId,r=this._sender.post(o,e),i=$.Deferred();return r.done(function(n,e,o){var r=n;if(null!==r)switch(r.ResponseType){case 0:i.resolve(r);break;case 1:var s=r.Payload,c=t._listener.listen(r.CommandId,s);c.done(function(n){i.resolve(n)})}}),r.fail(function(n,e,t){}),i.promise()},n}();n.CommandSender=o}(e=n.Infrastructure||(n.Infrastructure={}))}(CK||(CK={}));var CK;!function(n){var e;!function(n){$.connection.hub.logging=!0;var e=new n.SignalRListener($.connection.hub,"commandresponse");$.connection.hub.start().done(function(t){$.CK.commandSender=new n.CommandSender("/c",$.connection.hub.id,new n.AjaxSender,e)}).fail(function(n){throw new Error(n)})}(e=n.Infrastructure||(n.Infrastructure={}))}(CK||(CK={}));