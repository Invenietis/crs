define(["require","exports"],function(n,e){var o=function(){function n(){}return n.prototype.post=function(n,e){var o=JSON.stringify(e);return $.ajax(n,{type:"POST",data:o,contentType:"application/json",dataType:"JSON"})},n}();e.AjaxSender=o;var t=function(){function n(n,e){var o=this;this._receivedResponses=new Array,this._hubConnection=n,this._hubConnection.proxies[e].client.ReceiveCommandResponse=function(n){o._receivedResponses.push(n)}}return n.prototype.listen=function(n,e){if(e!==this._hubConnection.id)throw new Error("Try to listen to the wrong ConnectionId...");var o=this,t=$.Deferred(),i=setInterval(function(){o._receivedResponses.forEach(function(e,o,r){e.CommandId===n&&(clearInterval(i),r.splice(o,1),t.resolve(e))})},200);return t.promise()},n}();e.SignalRListener=t;var i=function(){function n(n,e,t,i){this._prefix=n,this._connectionId=e,this._sender=t||new o,this._listener=i}return n.prototype.send=function(n,e){var o=this;console.info("Sending Command to route: "+n);var t=this._prefix+"/"+n+"?c="+this._connectionId,i=this._sender.post(t,e),r=$.Deferred();return i.done(function(n,e,t){var i=n;if(null!==i)switch(i.ResponseType){case 0:r.resolve(i);break;case 1:var s=i.Payload,c=o._listener.listen(i.CommandId,s);c.done(function(n){r.resolve(n)})}}),i.fail(function(n,e,o){}),r.promise()},n}();e.CommandSender=i}),define(["require","exports","commands"],function(n,e,o){$.connection.hub.logging=!0;var t=new o.SignalRListener($.connection.hub,"commandresponse");$.connection.hub.start().done(function(n){CK.CommandSender=new o.CommandSender("/c",$.connection.hub.id,new o.AjaxSender,t)}).fail(function(n){throw new Error(n)})});